{{ define "main" }}
  {{ $dev := 0 | default $.Site.Params.dev }}


  <main class="block p-0 my-0 mx-auto max-w-[90vw] mt-[4rem]" role="main">
    <section class="py-2">
      <div
        class="{{ .Site.Params.Prose }} max-w-[90vw] mx-auto pt-3 pb-4 text-center">
        <h1 class="text-base md:text-xl">
          {{ .Title }}
        </h1>
      </div>

      <!-- ALPINE LIST -->
      <div class="w-full" x-data="collection" x-init="() => {refreshLists()}">
        <fieldset class="flex flex-wrap gap-2 px-4 py-3">
          <div class="">
            <label class="sr-only sr-only-focusable" for="theme">themes</label>
            <select
              class="rounded form-control border-neutral-6"
              id="theme"
              x-model="filters.theme">
              <option value="">All themes</option>
              <template x-for="theme in themes">
                <option x-text="theme"></option>
              </template>
            </select>
          </div>
          {{ if $dev }}
            <div class="">
              <label class="sr-only sr-only-focusable" for="hue">Hues</label>
              <select
              class="rounded form-control border-neutral-6"
              id="hue"
              x-model="filters.hue">
              <option value="">All hues</option>
              <template x-for="hue in sortedHues">
                <option x-text="hue"></option>
              </template>
            </select>
          </div>
          {{ end }}

          <div class="">
            <label class="sr-only sr-only-focusable" for="year">Years</label>
            <select
              class="rounded form-control border-neutral-6"
              id="year"
              x-model="filters.year">
              <option value="">All years</option>
              <template x-for="year in years">
                <option x-text="year"></option>
              </template>
            </select>
          </div>
          <div class="mb-0 form-group">
            <label class="sr-only sr-only-focusable" for="ratio">Ratio</label>
            <select
              class="bg-white rounded dark:bg-neutral-d-6 form-control border-neutral-6 text-neutral-11 dark:border-neutral-d-5 dark:text-neutral-d-11"
              id="ratio"
              x-model="filters.ratio">
              <option value="">All ratios</option>
              <template x-for="ratio in ratios">
                <option x-text="ratio"></option>
              </template>
            </select>
          </div>
          <button
            class="flex items-center gap-2 px-3 py-1 ml-3 bg-white rounded shadow text-neutral-11 dark:bg-black dark:text-neutral-d-11"
            x-show="filtersHaveValue()"
            x-on:click="resetFilters"
            x-transition>
            <span>
              <svg
                xmlns="https://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-x-lg"
                viewBox="0 0 16 16">
                <path
                  d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
              </svg>
            </span>
            <span x-text="artworkCounter"></span>
            <span class="text-bro"> Filters </span>
          </button>
        </fieldset>
        <div class="flex flex-wrap gap-2 px-4 py-3 mb-3">
          <template x-for="hue in sortedHues">
            <button
              class="flex justify-center items-center py-2 rounded grow min-w-[3rem] max-w-[3rem]"
              x-bind:class="{
                'bg-opacity-50': filters.hue != hue,
                'bg-opacity-100': filters.hue == hue
              }"
              x-bind:style="{
                'color': filters.hue !== hue ? `hsla(${hue}deg, 50%, 100%, 0)` : `hsl(0deg, 0%, 100%)`,
                'background': filters.hue !== hue ? `hsla(${hue}deg, 50%, 50%, var(--tw-bg-opacity))` : `hsla(${hue}deg, 50%, 50%, var(--tw-bg-opacity))`,
                'outline': filters.hue !== hue ? `3px solid hsla(${hue}deg, 50%, 50%, .8)` : `3px solid  hsla(${hue}deg, 50%, 50%, .3)`,
              }"
              x-on:click="filters.hue = (filters.hue == hue) ? '' : hue">
              <svg x-show="filters.hue === hue" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check2-square" viewBox="0 0 16 16">
                <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5H3z"/>
                <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0z"/>
              </svg>
              <svg  x-show="filters.hue !== hue" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-square" viewBox="0 0 16 16">
                <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
              </svg>
            </button>
          </template>
        </div>
        <div x-show="!isLoading" [x-cloak] class="">
          <ul class="flex flex-wrap justify-center gap-2 mx-auto md:gap-8">
            <template x-for="(artwork, index) in page().slice(0, limit)">
              <li
                class="listing-item w-full md:w-auto mx-4 md:mx-[initial] flex flex-col justify-between max-w-[20rem] p-2 mb-6 duration-500 ease-in-out bg-white rounded-sm hover:shadow-myShadow-hover shadow-myShadow dark:bg-neutralDark-3 border dark:border-neutralDark-3 hover:dark:border-neutralDark-5 dark:border-neutralDark-3 hover:dark:border-neutralDark-5">
                <div>
                  <img
                    draggable="false"
                    class="w-full rounded-sm"
                    x-bind:src="artwork.thumb_M"
                    x-bind:srcset="`
                    ${artwork.thumb_M} 303w,
                    ${artwork.thumb_L}  429w,
                    ${artwork.thumb_XL} 605w
                  `"
                    sizes="(min-width: 768px) 288px, calc(50vw - 36px)"
                    loading="lazy"
                    x-bind:width="artwork.thumb_M_w"
                    x-bind:height="artwork.thumb_M_h" />
                </div>
                <div class="flex flex-col w-full gap-2 pt-4">
                  <a class="artworkLink mainLink" :href="artwork.url"
                    ><h2
                      class="py-0 my-0 font-serif text-lg text-neutral-11 dark:text-neutralDark-11"
                      x-text="artwork.title"></h2
                  ></a>
                  
                  {{ if $dev }}
                    <div>
                      <template x-for="el in artwork.theme">
                        <span x-text="el"></span>
                      </template>
                    </div>
                    <div>
                      hues:
                      <template x-for="el in artwork.hue">
                        <span
                          x-bind:style="`background: hsl(${el}deg 50% 50%);`"
                          x-text="el"></span>
                        |
                      </template>
                    </div>
                    <div>
                      <span x-text="artwork.year"></span>
                    </div>
                    <div>
                      <span x-text="artwork.ratio"></span>
                    </div>
                  </div>
                  {{ end  }}
              </li>
            </template>
          </ul>
        </div>
      </div>
      <!-- END ALPINE LIST -->
      <div id="artworkList">
        <ul class="flex flex-wrap justify-center gap-2 mx-auto md:gap-8">
          {{ range .Paginator.Pages }}
            {{ partial "thumb-artwork.html" . }}
          {{ end }}
        </ul>
        {{ partial "site-pagination.html" .Paginator }}
      </div>

      <!-- Use JavaScript to hide the <ul> element if JavaScript is supported -->
      <script>
        // Check if JavaScript is supported by adding a class to the <ul>
        document.getElementById("artworkList").classList.add("js-supported");
      </script>
      <style>
        #artworkList.js-supported {
          display: none;
        }
      </style>
    </section>
  </main>
{{ end }}
